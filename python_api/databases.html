

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Databases &mdash; N2D2  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cells" href="cells.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> N2D2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about.html">About N2D2-IP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/simus.html">Performing simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/perfs_tools.html">Performance evaluation tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/tuto.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ONNX Import</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../onnx/convert.html">Obtain ONNX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx/import.html">Import ONNX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx/transfer.html">Train from ONNX models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quantization and Export</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quant/post.html">Post-training quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quant/qat.html">Quantization-Aware Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quant/pruning.html">Pruning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/CPP.html">Export: C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/CPP_STM32.html">Export: C++/STM32</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/TensorRT.html">Export: TensorRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/DNeuro.html">Export: DNeuro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/ONNX.html">Export: ONNX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/legacy.html">Export: other / legacy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">INI File Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ini/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/data_analysis.html">Stimuli data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/environment.html">Stimuli provider (Environment)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/layers.html">Network Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/target.html">Targets (outputs &amp; losses)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adversarial.html">Adversarial module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Databases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database">Database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dir">DIR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-a-custom-database">Loading a custom database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handling-labelization">Handling labelization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#numpy">Numpy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage-example">Usage example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mnist">MNIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ilsvrc2012">ILSVRC2012</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cifar10">CIFAR10</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cifar100">CIFAR100</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cityscapes">Cityscapes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gtsrb">GTSRB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#transformations">Transformations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#composite">Composite</a></li>
<li class="toctree-l3"><a class="reference internal" href="#padcrop">PadCrop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distortion">Distortion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rescale">Rescale</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reshape">Reshape</a></li>
<li class="toctree-l3"><a class="reference internal" href="#colorspace">ColorSpace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flip">Flip</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rangeaffine">RangeAffine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sliceextraction">SliceExtraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#randomresizecrop">RandomResizeCrop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#channelextraction">ChannelExtraction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sending-data-to-the-neural-network">Sending data to the Neural Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cells.html">Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensor.html">Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="interoperability.html">Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="export.html">Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++/Python core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/core.html">Core N2D2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/example.html">Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++ API / Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_intro.html">Introduction</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">N2D2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Databases</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/python_api/databases.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="databases">
<h1>Databases<a class="headerlink" href="#databases" title="Permalink to this heading">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>The python library integrates pre-defined modules for several well-known database used in the deep learning community, such as MNIST, GTSRB, CIFAR10 and so on.
That way, no extra step is necessary to be able to directly build a network and learn it on these database.
The library allow you to add pre-process data with built in Transformation.</p>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this heading">¶</a></h2>
<p>The python library provide you with multiple object to manipulate common database.</p>
<p>Loading hand made database can be done using <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.database.DIR</span></code>.</p>
<p>Like in the following example :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating the database object</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">DIR</span><span class="p">()</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">DataProvider</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">data_dims</span><span class="p">)</span>

<span class="c1"># The zeroes represent the depth to seek the data.</span>
<span class="n">db</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># With this line we put all the data in the learn partition:</span>
<span class="n">db</span><span class="o">.</span><span class="n">partition_stimuli</span><span class="p">(</span><span class="n">learn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">validation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">provider</span><span class="o">.</span><span class="n">set_partition</span><span class="p">(</span><span class="s2">&quot;Learn&quot;</span><span class="p">)</span>

<span class="n">inputs_tensor</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">read_random_batch</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="dir">
<h3>DIR<a class="headerlink" href="#dir" title="Permalink to this heading">¶</a></h3>
<div class="section" id="loading-a-custom-database">
<h4>Loading a custom database<a class="headerlink" href="#loading-a-custom-database" title="Permalink to this heading">¶</a></h4>
<p>Hand made database stored in files directories are directly supported
with the <code class="docutils literal notranslate"><span class="pre">DIR_Database</span></code> module. For example, suppose your database is
organized as following :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GST/airplanes</span></code>: 800 images</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GST/car_side</span></code>: 123 images</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GST/Faces</span></code>: 435 images</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GST/Motorbikes</span></code>: 798 images</p></li>
</ul>
<p>You can then instanciate this database as input of your neural network
using the following line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">DIR</span><span class="p">(</span><span class="s2">&quot;./GST&quot;</span><span class="p">,</span> <span class="n">learn</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">validation</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<p>Each subdirectory will be treated as a different label, so there will be
4 different labels, named after the directory name.</p>
<p>The stimuli are equi-partitioned for the learning set and the validation
set, meaning that the same number of stimuli for each category is used.
If the learn fraction is 0.4 and the validation fraction is 0.2, as in
the example above, the partitioning will be the following:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 24%" />
<col style="width: 16%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Label ID</p></td>
<td><p>Label name</p></td>
<td><p>Learn set</p></td>
<td><p>Validation set</p></td>
<td><p>Test set</p></td>
</tr>
<tr class="row-even"><td><p>[0.5ex] 0</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">airplanes</span></code></p></td>
<td><p>49</p></td>
<td><p>25</p></td>
<td><p>726</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">car_side</span></code></p></td>
<td><p>49</p></td>
<td><p>25</p></td>
<td><p>49</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Faces</span></code></p></td>
<td><p>49</p></td>
<td><p>25</p></td>
<td><p>361</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Motorbikes</span></code></p></td>
<td><p>49</p></td>
<td><p>25</p></td>
<td><p>724</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Total:</p></td>
<td><p>196</p></td>
<td><p>100</p></td>
<td><p>1860</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">equiv_label_partitioning</span></code> is 1 (default setting), the number of stimuli
per label that will be partitioned in the learn and validation sets will
correspond to the number of stimuli from the label with the fewest stimuli.</p>
</div>
<p>To load and partition more than one <code class="docutils literal notranslate"><span class="pre">DataPath</span></code>, one can use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.database.Database.load()</span></code> method.</p>
<p>This method will load data in the partition <code class="docutils literal notranslate"><span class="pre">Unpartitionned</span></code>, you can move the stimuli
in the <code class="docutils literal notranslate"><span class="pre">Learn</span></code>, <code class="docutils literal notranslate"><span class="pre">Validation</span></code> or <code class="docutils literal notranslate"><span class="pre">Test</span></code> partition using the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.database.Database.partition_stimuli()</span></code> method.</p>
</div>
<div class="section" id="handling-labelization">
<h4>Handling labelization<a class="headerlink" href="#handling-labelization" title="Permalink to this heading">¶</a></h4>
<p>By default, your labels will be ordered by alphabetical order.
If you need your label to be in a specific order, you can specify it using
an exterior file we will name it <code class="docutils literal notranslate"><span class="pre">label.dat</span></code> for this example :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">airplanes</span> <span class="mi">0</span>
<span class="n">car_side</span> <span class="mi">1</span>
<span class="n">Motorbikes</span> <span class="mi">3</span>
<span class="n">Faces</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Then to load the database we will use :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">database</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">DIR</span><span class="p">(</span><span class="s2">&quot;./GST&quot;</span><span class="p">,</span> <span class="n">learn</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">validation</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label_path</span><span class="o">=</span><span class="s2">&quot;./label.dat&quot;</span><span class="p">,</span> <span class="n">label_depth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is important to specify <code class="docutils literal notranslate"><span class="pre">label_depth=0</span></code> if you are specifying <code class="docutils literal notranslate"><span class="pre">label_path</span></code> !</p>
</div>
</div>
</div>
<div class="section" id="numpy">
<h3>Numpy<a class="headerlink" href="#numpy" title="Permalink to this heading">¶</a></h3>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.database.Numpy</span></code> allows to create a database using Numpy array.
This can be especially usefull if you already have a dataloader written in Python.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The labels are optional, this can be usefull if you have previously trained your model and only need data to calibrate you model using the <code class="xref py py-func docutils literal notranslate"><span class="pre">n2d2.quantizer.PTQ()</span></code> function.</p>
</div>
<div class="section" id="usage-example">
<h4>Usage example<a class="headerlink" href="#usage-example" title="Permalink to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">n2d2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">Numpy</span><span class="p">()</span>
<span class="n">db</span><span class="o">.</span><span class="n">load</span><span class="p">([</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span>
<span class="p">],</span>
<span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="mi">1</span>
<span class="p">])</span>
<span class="n">db</span><span class="o">.</span><span class="n">partition_stimuli</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span> <span class="c1"># Learn Validation Test</span>

<span class="n">provider</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">DataProvider</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">provider</span><span class="o">.</span><span class="n">set_partition</span><span class="p">(</span><span class="s2">&quot;Learn&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First stimuli :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">provider</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mnist">
<h3>MNIST<a class="headerlink" href="#mnist" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="ilsvrc2012">
<h3>ILSVRC2012<a class="headerlink" href="#ilsvrc2012" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="cifar10">
<h3>CIFAR10<a class="headerlink" href="#cifar10" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="cifar100">
<h3>CIFAR100<a class="headerlink" href="#cifar100" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="cityscapes">
<h3>Cityscapes<a class="headerlink" href="#cityscapes" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="gtsrb">
<h3>GTSRB<a class="headerlink" href="#gtsrb" title="Permalink to this heading">¶</a></h3>
</div>
</div>
<div class="section" id="transformations">
<h2>Transformations<a class="headerlink" href="#transformations" title="Permalink to this heading">¶</a></h2>
<div class="section" id="composite">
<h3>Composite<a class="headerlink" href="#composite" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="padcrop">
<h3>PadCrop<a class="headerlink" href="#padcrop" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="distortion">
<h3>Distortion<a class="headerlink" href="#distortion" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="rescale">
<h3>Rescale<a class="headerlink" href="#rescale" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="reshape">
<h3>Reshape<a class="headerlink" href="#reshape" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="colorspace">
<h3>ColorSpace<a class="headerlink" href="#colorspace" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="flip">
<h3>Flip<a class="headerlink" href="#flip" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="rangeaffine">
<h3>RangeAffine<a class="headerlink" href="#rangeaffine" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="sliceextraction">
<h3>SliceExtraction<a class="headerlink" href="#sliceextraction" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="randomresizecrop">
<h3>RandomResizeCrop<a class="headerlink" href="#randomresizecrop" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="channelextraction">
<h3>ChannelExtraction<a class="headerlink" href="#channelextraction" title="Permalink to this heading">¶</a></h3>
</div>
</div>
<div class="section" id="sending-data-to-the-neural-network">
<h2>Sending data to the Neural Network<a class="headerlink" href="#sending-data-to-the-neural-network" title="Permalink to this heading">¶</a></h2>
<p>Once a database is loaded, n2d2 use <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.provider.DataProvider</span></code> to provide data to the neural network.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.provider.DataProvider</span></code> will automatically apply the <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.transform.Transformation</span></code> to the dataset.
To add a transformation to the provider, you should use the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.transform.Transformation.add_transformation()</span></code>.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>In this example, we will show you how to create a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.database.Database</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.provider.Provider</span></code> and apply <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.transformation.Transformation</span></code> to the data.</p>
<p>We will use the <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.database.MNIST</span></code> database driver, rescale the images to a 32x32 pixels size and then print the data used for the learning.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading data</span>
<span class="n">database</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">validation</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Initializing DataProvider</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">DataProvider</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="c1"># Applying Transformation</span>
<span class="n">provider</span><span class="o">.</span><span class="n">add_transformation</span><span class="p">(</span><span class="n">n2d2</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">Rescale</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">32</span><span class="p">))</span>

<span class="c1"># Setting the partition of data we will use</span>
<span class="n">provider</span><span class="o">.</span><span class="n">set_partition</span><span class="p">(</span><span class="s2">&quot;Learn&quot;</span><span class="p">)</span>

<span class="c1"># Iterating other the inputs</span>
<span class="k">for</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="n">provider</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cells.html" class="btn btn-neutral float-right" title="Cells" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, CEA LIST

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cells &mdash; N2D2  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tensor" href="tensor.html" />
    <link rel="prev" title="Databases" href="databases.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> N2D2
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/about.html">About N2D2-IP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/simus.html">Performing simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/perfs_tools.html">Performance evaluation tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/tuto.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ONNX Import</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../onnx/convert.html">Obtain ONNX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx/import.html">Import ONNX models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx/transfer.html">Train from ONNX models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Quantization and Export</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quant/post.html">Post-training quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quant/qat.html">Quantization-Aware Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quant/pruning.html">Pruning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/CPP.html">Export: C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/CPP_STM32.html">Export: C++/STM32</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/TensorRT.html">Export: TensorRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/DNeuro.html">Export: DNeuro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/ONNX.html">Export: ONNX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../export/legacy.html">Export: other / legacy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">INI File Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ini/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/data_analysis.html">Stimuli data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/environment.html">Stimuli provider (Environment)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/layers.html">Network Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ini/target.html">Targets (outputs &amp; losses)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adversarial.html">Adversarial module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="databases.html">Databases</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Cells</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#block">Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sequence">Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layer">Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deepnetcell">DeepNetCell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Cells</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#neuralnetworkcell">NeuralNetworkCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conv">Conv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deconv">Deconv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fc">Fc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dropout">Dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elemwise">ElemWise</a></li>
<li class="toctree-l3"><a class="reference internal" href="#padding">Padding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#softmax">Softmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#batchnorm2d">BatchNorm2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pool">Pool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activation">Activation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reshape">Reshape</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resize">Resize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scaling">Scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transformation">Transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transpose">Transpose</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#saving-parameters">Saving parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-section">Configuration section</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage-example">Usage example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mapping">Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solver">Solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Usage example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-solver-at-construction-time">Set solver at construction time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-a-solver-for-a-specific-parameter">Set a solver for a specific parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-a-solver-for-a-model">Set a solver for a model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sgd">SGD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adam">Adam</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#filler">Filler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Usage example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-a-filler-at-construction-time">Setting a filler at construction time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changing-the-filler-of-an-instanciated-object">Changing the filler of an instanciated object</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#he">He</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normal">Normal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constant">Constant</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xavier">Xavier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#activations">Activations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linear">Linear</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rectifier">Rectifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tanh">Tanh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#target">Target</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Usage example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tensor.html">Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="interoperability.html">Interoperability</a></li>
<li class="toctree-l1"><a class="reference internal" href="export.html">Export</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++/Python core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/core.html">Core N2D2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/example.html">Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++ API / Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_intro.html">Introduction</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">N2D2</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Cells</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/python_api/cells.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cells">
<h1>Cells<a class="headerlink" href="#cells" title="Permalink to this heading">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>Cell objects are the atomics elements that compose a deep neural network.</p>
<p>They are the node of the computation graph. <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.NeuralNetworkCell</span></code> are not dependant of a DeepNet this allow a dynamic management of the computation.</p>
<dl class="simple">
<dt>Cells are organize with the following logic :</dt><dd><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.NeuralNetworkCell</span></code> : Atomic cell of a neural network;</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Block</span></code> : Store a collection of <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.NeuralNetworkCell</span></code>, the storage order does <strong>not</strong> determine the graph computation;</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell</span></code> : This cell allow you to use an <code class="xref py py-class docutils literal notranslate"><span class="pre">N2D2.DeepNet</span></code>, it can be used for <cite>ONNX</cite> and <cite>INI</cite> import or to run optimize learning;</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Iterable</span></code> : Similar to <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Block</span></code> but the order of storage determine the computation graph;</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Sequence</span></code> : A vertical structure to create neural network;</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Layer</span></code> : An horizontal structure to create neural network.</p></li>
</ul>
</dd>
</dl>
<div class="figure align-default">
<img alt="Cell class diagram" src="../_images/n2d2_cell_diagram.png" />
</div>
<div class="section" id="block">
<h3>Block<a class="headerlink" href="#block" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="sequence">
<h3>Sequence<a class="headerlink" href="#sequence" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="layer">
<h3>Layer<a class="headerlink" href="#layer" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="deepnetcell">
<h3>DeepNetCell<a class="headerlink" href="#deepnetcell" title="Permalink to this heading">¶</a></h3>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell</span></code> constructor require an <code class="xref py py-class docutils literal notranslate"><span class="pre">N2D2.DeepNet</span></code>. In practice, you will not use the constructor directly.</p>
<p>There are three methods to generate a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell</span></code> : <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell.load_from_ONNX()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell.load_from_INI()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Sequence.to_deepnet_cell()</span></code></p>
<p>The DeepNetCell can be used to train the neural network in an efficient way thanks to <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell.fit()</span></code>.</p>
<div class="section" id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h4>
<p>You can create a DeepNet cell with <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell.load_from_ONNX()</span></code> :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">database</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">validation</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">DataProvider</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">DeepNetCell</span><span class="o">.</span><span class="n">load_from_ONNX</span><span class="p">(</span><span class="n">provider</span><span class="p">,</span> <span class="n">ONNX_PATH</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">nb_epochs</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">run_test</span><span class="p">()</span>
</pre></div>
</div>
<p>Using <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell.fit()</span></code> method will reduce the learning time as it will parallelize the loading of the batch of data and the propagation.</p>
<p>If you want to use the dynamic computation graph  provided by the API, you can use the <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.DeepNetCell</span></code> as a simple cell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">database</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">validation</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">provider</span><span class="o">.</span><span class="n">DataProvider</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">DeepNetCell</span><span class="o">.</span><span class="n">load_from_ONNX</span><span class="p">(</span><span class="n">provider</span><span class="p">,</span> <span class="n">ONNX_PATH</span><span class="p">)</span>
<span class="n">sequence</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Sequence</span><span class="p">([</span><span class="n">model</span><span class="p">,</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">with_loss</span><span class="o">=</span><span class="kc">True</span><span class="p">)])</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">DIMS</span><span class="p">)</span>
<span class="n">output_tensor</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Cells<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<div class="section" id="neuralnetworkcell">
<h3>NeuralNetworkCell<a class="headerlink" href="#neuralnetworkcell" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="conv">
<h3>Conv<a class="headerlink" href="#conv" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="deconv">
<h3>Deconv<a class="headerlink" href="#deconv" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="fc">
<h3>Fc<a class="headerlink" href="#fc" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="dropout">
<h3>Dropout<a class="headerlink" href="#dropout" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="elemwise">
<h3>ElemWise<a class="headerlink" href="#elemwise" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="padding">
<h3>Padding<a class="headerlink" href="#padding" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="softmax">
<h3>Softmax<a class="headerlink" href="#softmax" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="batchnorm2d">
<h3>BatchNorm2d<a class="headerlink" href="#batchnorm2d" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="pool">
<h3>Pool<a class="headerlink" href="#pool" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="activation">
<h3>Activation<a class="headerlink" href="#activation" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="reshape">
<h3>Reshape<a class="headerlink" href="#reshape" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="resize">
<h3>Resize<a class="headerlink" href="#resize" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="scaling">
<h3>Scaling<a class="headerlink" href="#scaling" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="transformation">
<h3>Transformation<a class="headerlink" href="#transformation" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="transpose">
<h3>Transpose<a class="headerlink" href="#transpose" title="Permalink to this heading">¶</a></h3>
</div>
</div>
<div class="section" id="saving-parameters">
<h2>Saving parameters<a class="headerlink" href="#saving-parameters" title="Permalink to this heading">¶</a></h2>
<p>You can save the parameters (weights, biases …) of your network with the method <cite>export_free_parameters</cite>.
To load those parameters you can use the method <cite>import_free_parameters</cite>.</p>
<p>With n2d2 you can choose wether you want to save the parameters of a part of your network or of all your graph.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 38%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Object</p></th>
<th class="head"><p>Save parameters</p></th>
<th class="head"><p>Load parameters</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.NeuralNetworkCell</span></code></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.NeuralNetworkCell.export_free_parameters()</span></code></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.NeuralNetworkCell.import_free_parameters()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Block</span></code></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Block.import_free_parameters()</span></code></p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Block.import_free_parameters()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configuration-section">
<h2>Configuration section<a class="headerlink" href="#configuration-section" title="Permalink to this heading">¶</a></h2>
<p>If you want to add the same parameters to multiple cells, you can use a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.ConfigSection</span></code>.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.ConfigSection</span></code> are used like dictionaries and passes to the constructor of classes like <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>.</p>
<div class="section" id="usage-example">
<h3>Usage example<a class="headerlink" href="#usage-example" title="Permalink to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conv_config</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">ConfigSection</span><span class="p">(</span><span class="n">no_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Conv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="o">**</span><span class="n">conv_config</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Conv</span></code> with the parameter <cite>no_bias=True</cite>.
This functionality allow you to write more concise code, when multiple cells share the same parameters.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you want to pass an object as a parameter for multiple n2d2 object. You need to create a wrapping function to create your object.
Example :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">conv_def</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">ConfigSection</span><span class="p">(</span><span class="n">weights_solver</span><span class="o">=</span><span class="n">n2d2</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">SGD</span><span class="p">())</span>
<span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Conv</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="o">**</span><span class="n">conv_def</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mapping">
<h2>Mapping<a class="headerlink" href="#mapping" title="Permalink to this heading">¶</a></h2>
<p>You can change the mapping of the input for some cells (see if they have <code class="docutils literal notranslate"><span class="pre">mapping</span></code> parameter available).</p>
<p>You can create a mapping manually with a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.Tensor</span></code> object :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span><span class="o">=</span><span class="n">n2d2</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;bool&quot;</span><span class="p">)</span>
<span class="n">mapping</span><span class="o">.</span><span class="n">set_values</span><span class="p">([</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<p>Or use the Mapping object :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span><span class="o">=</span><span class="n">n2d2</span><span class="o">.</span><span class="n">mapping</span><span class="o">.</span><span class="n">Mapping</span><span class="p">(</span><span class="n">nb_channels_per_group</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">create_mapping</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
<p>Which create the following mapping :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1
</pre></div>
</div>
</div>
<div class="section" id="solver">
<h2>Solver<a class="headerlink" href="#solver" title="Permalink to this heading">¶</a></h2>
<p>You can associate at construction and run time a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.solver.Solver</span></code> object to a cell. This solver object will optimize the parameters of your cell using a specific algorithm.</p>
<div class="section" id="id2">
<h3>Usage example<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<p>In this short example we will see how to associate a solver to a model and to a cell object at construction and at runtime.</p>
<div class="section" id="set-solver-at-construction-time">
<h4>Set solver at construction time<a class="headerlink" href="#set-solver-at-construction-time" title="Permalink to this heading">¶</a></h4>
<p>Let’s create a couple of <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Fc</span></code> cell and add them to a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Sequence</span></code>.
At construction time we will set the solver of one of them to a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.solver.SGD</span></code> with a <code class="docutils literal notranslate"><span class="pre">learning_rate=0.1</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">n2d2</span>

<span class="n">cell1</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Fc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">n2d2</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">cell2</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Fc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Sequence</span><span class="p">([</span><span class="n">cell1</span><span class="p">,</span> <span class="n">cell2</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output :</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;Sequence_0&#39; Sequence(
        (0): &#39;Fc_0&#39; Fc(Frame&lt;float&gt;)(nb_inputs=2, nb_outputs=2 | back_propagate=True, drop_connect=1.0, no_bias=False, normalize=False, outputs_remap=, weights_export_format=OC, activation=None, weights_solver=SGD(clamping=, decay=0.0, iteration_size=1, learning_rate=0.1, learning_rate_decay=0.1, learning_rate_policy=None, learning_rate_step_size=1, max_iterations=0, min_decay=0.0, momentum=0.0, polyak_momentum=True, power=0.0, warm_up_duration=0, warm_up_lr_frac=0.25), bias_solver=SGD(clamping=, decay=0.0, iteration_size=1, learning_rate=0.1, learning_rate_decay=0.1, learning_rate_policy=None, learning_rate_step_size=1, max_iterations=0, min_decay=0.0, momentum=0.0, polyak_momentum=True, power=0.0, warm_up_duration=0, warm_up_lr_frac=0.25), weights_filler=Normal(mean=0.0, std_dev=0.05), bias_filler=Normal(mean=0.0, std_dev=0.05), quantizer=None)
        (1): &#39;Fc_1&#39; Fc(Frame&lt;float&gt;)(nb_inputs=2, nb_outputs=2 | back_propagate=True, drop_connect=1.0, no_bias=False, normalize=False, outputs_remap=, weights_export_format=OC, activation=None, weights_solver=SGD(clamping=, decay=0.0, iteration_size=1, learning_rate=0.01, learning_rate_decay=0.1, learning_rate_policy=None, learning_rate_step_size=1, max_iterations=0, min_decay=0.0, momentum=0.0, polyak_momentum=True, power=0.0, warm_up_duration=0, warm_up_lr_frac=0.25), bias_solver=SGD(clamping=, decay=0.0, iteration_size=1, learning_rate=0.01, learning_rate_decay=0.1, learning_rate_policy=None, learning_rate_step_size=1, max_iterations=0, min_decay=0.0, momentum=0.0, polyak_momentum=True, power=0.0, warm_up_duration=0, warm_up_lr_frac=0.25), weights_filler=Normal(mean=0.0, std_dev=0.05), bias_filler=Normal(mean=0.0, std_dev=0.05), quantizer=None)
)
</pre></div>
</div>
</div>
<div class="section" id="set-a-solver-for-a-specific-parameter">
<h4>Set a solver for a specific parameter<a class="headerlink" href="#set-a-solver-for-a-specific-parameter" title="Permalink to this heading">¶</a></h4>
<p>We can set a new solver for the bias of the second cell fully connected cell. This solver will be different than the weight parameter one.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we access the cell via its instanciate object but we could have used its name : <code class="docutils literal notranslate"><span class="pre">model[&quot;Fc_1&quot;].bias_solver=n2d2.solver.Adam()</span></code>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell2</span><span class="o">.</span><span class="n">bias_solver</span><span class="o">=</span><span class="n">n2d2</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">Adam</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output :</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;Sequence_0&#39; Sequence(
        (0): &#39;Fc_0&#39; Fc(Frame&lt;float&gt;)(nb_inputs=2, nb_outputs=2 | back_propagate=True, drop_connect=1.0, no_bias=False, normalize=False, outputs_remap=, weights_export_format=OC, activation=None, weights_solver=SGD(clamping=, decay=0.0, iteration_size=1, learning_rate=0.1, learning_rate_decay=0.1, learning_rate_policy=None, learning_rate_step_size=1, max_iterations=0, min_decay=0.0, momentum=0.0, polyak_momentum=True, power=0.0, warm_up_duration=0, warm_up_lr_frac=0.25), bias_solver=SGD(clamping=, decay=0.0, iteration_size=1, learning_rate=0.1, learning_rate_decay=0.1, learning_rate_policy=None, learning_rate_step_size=1, max_iterations=0, min_decay=0.0, momentum=0.0, polyak_momentum=True, power=0.0, warm_up_duration=0, warm_up_lr_frac=0.25), weights_filler=Normal(mean=0.0, std_dev=0.05), bias_filler=Normal(mean=0.0, std_dev=0.05), quantizer=None)
        (1): &#39;Fc_1&#39; Fc(Frame&lt;float&gt;)(nb_inputs=2, nb_outputs=2 | back_propagate=True, drop_connect=1.0, no_bias=False, normalize=False, outputs_remap=, weights_export_format=OC, activation=None, weights_solver=SGD(clamping=, decay=0.0, iteration_size=1, learning_rate=0.01, learning_rate_decay=0.1, learning_rate_policy=None, learning_rate_step_size=1, max_iterations=0, min_decay=0.0, momentum=0.0, polyak_momentum=True, power=0.0, warm_up_duration=0, warm_up_lr_frac=0.25), bias_solver=Adam(beta1=0.9, beta2=0.999, clamping=, epsilon=1e-08, learning_rate=0.001), weights_filler=Normal(mean=0.0, std_dev=0.05), bias_filler=Normal(mean=0.0, std_dev=0.05), quantizer=None)
)
</pre></div>
</div>
</div>
<div class="section" id="set-a-solver-for-a-model">
<h4>Set a solver for a model<a class="headerlink" href="#set-a-solver-for-a-model" title="Permalink to this heading">¶</a></h4>
<p>We can set a solver to the whole <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Sequence</span></code> with the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Sequence.set_solver()</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">set_solver</span><span class="p">(</span><span class="n">n2d2</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output :</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;Sequence_0&#39; Sequence(
        (0): &#39;Fc_0&#39; Fc(Frame&lt;float&gt;)(nb_inputs=2, nb_outputs=2 | back_propagate=True, drop_connect=1.0, no_bias=False, normalize=False, outputs_remap=, weights_export_format=OC, activation=None, weights_solver=Adam(beta1=0.9, beta2=0.999, clamping=, epsilon=1e-08, learning_rate=0.1), bias_solver=Adam(beta1=0.9, beta2=0.999, clamping=, epsilon=1e-08, learning_rate=0.1), weights_filler=Normal(mean=0.0, std_dev=0.05), bias_filler=Normal(mean=0.0, std_dev=0.05), quantizer=None)
        (1): &#39;Fc_1&#39; Fc(Frame&lt;float&gt;)(nb_inputs=2, nb_outputs=2 | back_propagate=True, drop_connect=1.0, no_bias=False, normalize=False, outputs_remap=, weights_export_format=OC, activation=None, weights_solver=Adam(beta1=0.9, beta2=0.999, clamping=, epsilon=1e-08, learning_rate=0.1), bias_solver=Adam(beta1=0.9, beta2=0.999, clamping=, epsilon=1e-08, learning_rate=0.1), weights_filler=Normal(mean=0.0, std_dev=0.05), bias_filler=Normal(mean=0.0, std_dev=0.05), quantizer=None)
)
</pre></div>
</div>
</div>
</div>
<div class="section" id="sgd">
<h3>SGD<a class="headerlink" href="#sgd" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="adam">
<h3>Adam<a class="headerlink" href="#adam" title="Permalink to this heading">¶</a></h3>
</div>
</div>
<div class="section" id="filler">
<h2>Filler<a class="headerlink" href="#filler" title="Permalink to this heading">¶</a></h2>
<p>You can associate to a cell at construction time a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.filler.Filler</span></code> object. This object will fill weights and biases using a specific method.</p>
<div class="section" id="id3">
<h3>Usage example<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>In this short example we will see how to associate a filler to a cell object, how to get the weights and biases and how to set a new filler and refill the weights.</p>
<div class="section" id="setting-a-filler-at-construction-time">
<h4>Setting a filler at construction time<a class="headerlink" href="#setting-a-filler-at-construction-time" title="Permalink to this heading">¶</a></h4>
<p>We begin by importing <code class="docutils literal notranslate"><span class="pre">n2d2</span></code> and creating a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.cells.Fc</span></code> object. We will associate a <code class="xref py py-class docutils literal notranslate"><span class="pre">n2d2.filler.Constant</span></code> filler.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to set a filler only for weights (or biases) you could have used the parameter <code class="docutils literal notranslate"><span class="pre">weight_filler</span></code> (or <code class="docutils literal notranslate"><span class="pre">bias_filler</span></code>).</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">n2d2</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">n2d2</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">Fc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">filler</span><span class="o">=</span><span class="n">n2d2</span><span class="o">.</span><span class="n">filler</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
<p>If you print the weights, you will see that they are all set to one.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Weights ---&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_weights</span><span class="p">():</span>
<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">channel</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output :</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--- Weights ---
n2d2.Tensor([
1
], device=cpu, datatype=f)
n2d2.Tensor([
1
], device=cpu, datatype=f)
n2d2.Tensor([
1
], device=cpu, datatype=f)
n2d2.Tensor([
1
], device=cpu, datatype=f)
</pre></div>
</div>
<p>Same with the biases</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Biases ---&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_biases</span><span class="p">():</span>
<span class="nb">print</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output :</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--- Biases ---
n2d2.Tensor([
1
], device=cpu, datatype=f)
n2d2.Tensor([
1
], device=cpu, datatype=f)
</pre></div>
</div>
</div>
<div class="section" id="changing-the-filler-of-an-instanciated-object">
<h4>Changing the filler of an instanciated object<a class="headerlink" href="#changing-the-filler-of-an-instanciated-object" title="Permalink to this heading">¶</a></h4>
<p>You can set a new filler for bias by changing the <code class="docutils literal notranslate"><span class="pre">bias_filler</span></code> attribute (or <code class="docutils literal notranslate"><span class="pre">weight_filler</span></code> for only weights or <code class="docutils literal notranslate"><span class="pre">filer</span></code> for both).</p>
<p>However changing the filler doesn’t change the parameter values, you need to use the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Fc.refill_bias()</span></code> (see also <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Fc.refill_weights()</span></code>)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also use the method  <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Fc.set_filler()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Fc.set_weights_filler()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">n2d2.cells.Fc.set_biases_filler()</span></code>. Which have a refill option.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell</span><span class="o">.</span><span class="n">bias_filler</span><span class="o">=</span><span class="n">n2d2</span><span class="o">.</span><span class="n">filler</span><span class="o">.</span><span class="n">Normal</span><span class="p">()</span>
<span class="n">cell</span><span class="o">.</span><span class="n">refill_bias</span><span class="p">()</span>
</pre></div>
</div>
<p>You can then observe the new biases :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- New Biases ---&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_biases</span><span class="p">():</span>
<span class="nb">print</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output :</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>--- New Biases ---
n2d2.Tensor([
1.32238
], device=cpu, datatype=f)
n2d2.Tensor([
-0.0233932
], device=cpu, datatype=f)
</pre></div>
</div>
</div>
</div>
<div class="section" id="he">
<h3>He<a class="headerlink" href="#he" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="normal">
<h3>Normal<a class="headerlink" href="#normal" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="constant">
<h3>Constant<a class="headerlink" href="#constant" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="xavier">
<h3>Xavier<a class="headerlink" href="#xavier" title="Permalink to this heading">¶</a></h3>
</div>
</div>
<div class="section" id="activations">
<h2>Activations<a class="headerlink" href="#activations" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>You can associate to some cell an activation function.</p>
</div></blockquote>
<div class="section" id="linear">
<h3>Linear<a class="headerlink" href="#linear" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="rectifier">
<h3>Rectifier<a class="headerlink" href="#rectifier" title="Permalink to this heading">¶</a></h3>
</div>
<div class="section" id="tanh">
<h3>Tanh<a class="headerlink" href="#tanh" title="Permalink to this heading">¶</a></h3>
</div>
</div>
<div class="section" id="target">
<h2>Target<a class="headerlink" href="#target" title="Permalink to this heading">¶</a></h2>
<p>Last cell of the network this object computes the loss.</p>
<p>To understand what the Target does, please refer to this part of the documentation : <a class="reference internal" href="../ini/target.html"><span class="doc">Target INI</span></a>.</p>
<div class="section" id="id4">
<h3>Usage example<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<p>How to use a <cite>Target</cite> to train your model :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Propagation &amp; BackPropagation example</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">stimuli</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">target</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="n">loss</span><span class="o">.</span><span class="n">back_propagate</span><span class="p">()</span>
<span class="n">loss</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<p>Log performance analysis of your training :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### After validation ###</span>
<span class="c1"># save computational stats of the network</span>
<span class="n">target</span><span class="o">.</span><span class="n">log_stats</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
<span class="c1"># save a confusion matrix</span>
<span class="n">target</span><span class="o">.</span><span class="n">log_confusion_matrix</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
<span class="c1"># save a graph of the loss and the validation score as a function of the number of steps</span>
<span class="n">target</span><span class="o">.</span><span class="n">log_success</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tensor.html" class="btn btn-neutral float-right" title="Tensor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="databases.html" class="btn btn-neutral float-left" title="Databases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, CEA LIST

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>